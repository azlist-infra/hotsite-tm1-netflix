# ğŸ“¸ Componente Image - DocumentaÃ§Ã£o

Sistema avanÃ§ado de imagens com mÃºltiplos providers, otimizaÃ§Ã£o automÃ¡tica, controle SVG e fallbacks inteligentes.

## ğŸ“‹ Ãndice

- [InstalaÃ§Ã£o](#instalaÃ§Ã£o)
- [Uso BÃ¡sico](#uso-bÃ¡sico)
- [Controle SVG](#controle-svg)
- [Providers de Imagem](#providers-de-imagem)
- [Componentes de ConveniÃªncia](#componentes-de-conveniÃªncia)
- [Performance e Loading](#performance-e-loading)
- [Fallbacks e Error Handling](#fallbacks-e-error-handling)
- [Props Completas](#props-completas)
- [Exemplos PrÃ¡ticos](#exemplos-prÃ¡ticos)

---

## ğŸš€ InstalaÃ§Ã£o

```tsx
import { Image, Avatar, Hero, Thumbnail, SvgIcon } from "@/components/ui/image"
```

## ğŸ—ï¸ Arquitetura Modular

O sistema de imagens utiliza uma **arquitetura modular** que faz triagem automÃ¡tica entre imagens tradicionais e SVGs:

### Estrutura de Arquivos
```
src/lib/components/ui/image/
â”œâ”€â”€ index.ts              # Componente principal com triagem automÃ¡tica
â”œâ”€â”€ Image.tsx             # Componente para imagens tradicionais (PNG, JPG, etc.)
â”œâ”€â”€ Svg.tsx               # Componente especializado para SVGs
â”œâ”€â”€ convenience.tsx       # Componentes de conveniÃªncia (Avatar, Hero, etc.)
â”œâ”€â”€ types.ts              # Tipos TypeScript compartilhados
â””â”€â”€ utils/                # FunÃ§Ãµes auxiliares
    â”œâ”€â”€ providers.ts      # LÃ³gica de providers (Cloudflare, Cloudinary)
    â”œâ”€â”€ image-helpers.ts  # Utilidades para imagens
    â””â”€â”€ svg-helpers.ts    # Utilidades especÃ­ficas para SVG
```

### Triagem Inteligente
O componente `Image` principal detecta automaticamente o tipo de arquivo:

```tsx
// Detecta SVG automaticamente e usa componente especializado
<Image src="/icon.svg" svgColor="brand.500" />

// Detecta imagem tradicional e usa componente otimizado  
<Image src="/photo.jpg" aspectRatio="16/9" />
```

**Vantagens:**
- âœ… **API Unificada**: Um componente para todos os tipos
- âœ… **OtimizaÃ§Ã£o EspecÃ­fica**: LÃ³gica especializada para cada tipo
- âœ… **Manutenibilidade**: CÃ³digo organizado em mÃ³dulos
- âœ… **Tree Shaking**: Importa apenas o necessÃ¡rio

---

## ğŸ“¦ Uso BÃ¡sico

### Image PadrÃ£o
```tsx
<Image 
  src="/logo.png" 
  alt="Logo" 
  width={120}
  height={80}
/>
```

### Image com Link
```tsx
<Image 
  src="/logo.png" 
  alt="Logo" 
  href="/dashboard"
  width={120}
  height={80}
/>
```

### Image com Border Radius
```tsx
<Image 
  src="/logo.png" 
  alt="Logo" 
  rounded={12}
  width={120}
  height={80}
/>
```

---

## ğŸ¨ Controle SVG

O componente oferece **3 estratÃ©gias** para controle de cores SVG:

### 1. CSS Filters (Mais RÃ¡pido)
```tsx
// Qualquer cor HEX
<Image src="/icon.svg" svgColor="#ff6b6b" />
<Image src="/icon.svg" svgColor="#4ecdc4" />
<Image src="/icon.svg" svgColor="#9b59b6" />

// Cores nomeadas CSS
<Image src="/icon.svg" svgColor="red" />
<Image src="/icon.svg" svgColor="crimson" />
<Image src="/icon.svg" svgColor="orange" />

// Cores do Chakra UI (dinÃ¢micas)
<Image src="/icon.svg" svgColor="brand.500" />
<Image src="/icon.svg" svgColor="blue.400" />
<Image src="/icon.svg" svgColor="green.200" />

// Filtros CSS customizados
<Image src="/icon.svg" svgFilter="hue-rotate(120deg)" />
<Image src="/icon.svg" svgFilter="sepia(100%) saturate(200%)" />
```

**Vantagens:**
- âœ… Performance mÃ¡xima
- âœ… Sem requests adicionais
- âœ… Aceita qualquer cor HEX, nomeada ou Chakra UI
- âœ… ResoluÃ§Ã£o dinÃ¢mica de tokens do design system
- âœ… CompatÃ­vel com Next.js Image
- âœ… ConversÃ£o automÃ¡tica HEX â†’ CSS Filter

**LimitaÃ§Ãµes:**
- âŒ AproximaÃ§Ã£o da cor (pode ter pequenas variaÃ§Ãµes)
- âŒ Sem controle granular de mÃºltiplas cores

### 2. SVG Inline (Controle Total)
```tsx
<Image 
  src="/icon.svg" 
  renderSvgInline
  svgFill="#22c55e"      // Cor de preenchimento (HEX)
  svgStroke="purple.500" // Cor de contorno (Chakra UI)
  svgStrokeWidth={2}     // Largura do contorno
/>

// Exemplo com cores customizadas do tema
<Image 
  src="/icon.svg" 
  renderSvgInline
  svgFill="brand.600"    // Suas cores customizadas!
/>
```

**Vantagens:**
- âœ… Controle total sobre fill/stroke
- âœ… Cores exatas (HEX, RGB, HSL, Chakra UI)
- âœ… Suporte a tokens customizados do design system
- âœ… ModificaÃ§Ã£o de mÃºltiplos atributos

**LimitaÃ§Ãµes:**
- âŒ Fetch adicional do SVG
- âŒ Re-render ao mudar props

### 3. SvgIcon Component (HÃ­brido)
```tsx
<SvgIcon 
  src="/icon.svg"
  width={24}
  height={24}
  svgFill="brand.500"    // Cores do seu tema!
/>
```

**Vantagens:**
- âœ… Inline automÃ¡tico
- âœ… API simplificada
- âœ… Otimizado para Ã­cones

---

## ğŸŒ Providers de Imagem

### Next.js (PadrÃ£o)
```tsx
<Image src="/logo.png" provider="next" />
```

### Cloudflare Images
```tsx
<Image src="image-id" provider="cloudflare" />
```
**VariÃ¡vel de ambiente:**
```env
NEXT_PUBLIC_CLOUDFLARE_ACCOUNT_HASH=your_hash_here
```

### Cloudinary
```tsx
<Image src="sample.jpg" provider="cloudinary" />
```
**VariÃ¡vel de ambiente:**
```env
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=your_cloud_name
```

### Provider Customizado
```tsx
import { createCustomProvider } from "@/components/ui/image/Image"

const myProvider = {
  name: 'custom',
  getUrl: (src, options) => `https://mycdn.com/${src}?w=${options.width}`,
}

<Image 
  src="image.jpg" 
  provider="custom"
  customProvider={myProvider}
/>
```

---

## ğŸ¯ Componentes de ConveniÃªncia

### Avatar
```tsx
<Avatar 
  src="/user.jpg" 
  alt="JoÃ£o Silva"
  width={80}
  height={80}
/>
```
- âœ… Circular automÃ¡tico (`rounded="50%"`)
- âœ… `aspectRatio={1}` (quadrado)
- âœ… `objectFit="cover"`

### Hero
```tsx
<Hero 
  src="/banner.jpg" 
  alt="Hero banner"
  width={400}
  height={200}
/>
```
- âœ… `priority={true}` (carregamento prioritÃ¡rio)
- âœ… `responsive={true}` (imagens responsivas)
- âœ… `objectFit="cover"`

### Thumbnail
```tsx
<Thumbnail 
  src="/post.jpg" 
  alt="Post thumbnail"
  width={200}
/>
```
- âœ… `aspectRatio="4/3"`
- âœ… `lazy={true}` (lazy loading)
- âœ… `objectFit="cover"`

### SvgIcon
```tsx
<SvgIcon 
  src="/icon.svg"
  width={24}
  height={24}
  svgFill="#3b82f6"
/>
```
- âœ… `renderSvgInline={true}` (inline automÃ¡tico)
- âœ… Controle total de cores
- âœ… Otimizado para Ã­cones

---

## âš¡ Performance e Loading

### EstratÃ©gias de Loading
```tsx
// Carregamento prioritÃ¡rio (above-the-fold)
<Image src="/hero.jpg" priority />

// Lazy loading (padrÃ£o)
<Image src="/content.jpg" lazy />

// Carregamento imediato
<Image src="/above.jpg" eager />

// Preload no <head>
<Image src="/important.jpg" preload />
```

### Responsive Images
```tsx
<Image 
  src="/responsive.jpg" 
  sizes="(max-width: 768px) 100vw, 50vw"
  responsive
/>

// Com breakpoints customizados
<Image 
  src="/responsive.jpg"
  sizes={[
    { breakpoint: '640px', width: 320 },
    { breakpoint: '1024px', width: 512 },
    { breakpoint: '1440px', width: 720 }
  ]}
/>
```

### OtimizaÃ§Ãµes AutomÃ¡ticas
```tsx
<Image 
  src="/photo.jpg"
  imageOptions={{
    quality: 90,        // Qualidade da imagem
    format: 'webp',     // Formato de saÃ­da
    blur: false         // Blur placeholder
  }}
/>
```

---

## ğŸ›¡ï¸ Fallbacks e Error Handling

### Fallback AutomÃ¡tico
```tsx
<Image 
  src="/might-fail.jpg" 
  alt="Imagem"
  fallback="no-image.png"
  showFallbackOnError
/>
```

### Fallback Component
```tsx
const CustomFallback = () => (
  <div style={{ 
    width: '150px', 
    height: '100px', 
    backgroundColor: '#f0f0f0',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center'
  }}>
    <span>Imagem nÃ£o encontrada</span>
  </div>
)

<Image 
  src="/fail.jpg" 
  fallbackComponent={<CustomFallback />}
/>
```

---

## ğŸ“ Aspect Ratio e Object Fit

```tsx
// Aspect ratios comuns
<Image src="/photo.jpg" aspectRatio={1} />          // 1:1 (quadrado)
<Image src="/photo.jpg" aspectRatio="16/9" />       // 16:9 (widescreen)
<Image src="/photo.jpg" aspectRatio="4/3" />        // 4:3 (clÃ¡ssico)
<Image src="/photo.jpg" aspectRatio={0.75} />       // 3:4 (portrait)

// Object fit
<Image src="/photo.jpg" objectFit="cover" />    // Preenche cortando
<Image src="/photo.jpg" objectFit="contain" />  // Ajusta mantendo proporÃ§Ã£o
<Image src="/photo.jpg" objectFit="fill" />     // Estica para preencher
```

---

## ğŸ“‹ Props Completas

```tsx
interface ImgProps {
  // === ESSENTIALS ===
  src: string | null                    // URL da imagem
  alt?: string                          // Texto alternativo
  width?: number                        // Largura
  height?: number                       // Altura
  
  // === LAYOUT & STYLING ===
  objectFit?: 'cover' | 'contain' | 'fill' | 'scale-down'
  aspectRatio?: number | string         // Ex: 1, "16/9", "4/3"
  rounded?: boolean | number | string   // Border radius
  bgColor?: string                      // Cor de fundo
  
  // === SVG SPECIFIC ===
  svgColor?: string                     // Cor primÃ¡ria (CSS filter)
  svgFill?: string                      // Cor de preenchimento (inline)
  svgStroke?: string                    // Cor de contorno (inline)
  svgStrokeWidth?: number               // Largura do contorno (inline)
  svgFilter?: string                    // Filtro CSS customizado
  renderSvgInline?: boolean             // Renderizar inline para controle total
  
  // === RESPONSIVE ===
  sizes?: string | ResponsiveImageSize[] // Breakpoints
  responsive?: boolean                   // Habilita responsive
  
  // === LINKING ===
  href?: string                         // Link de navegaÃ§Ã£o
  external?: boolean                    // Link externo
  target?: '_blank' | '_self' | '_parent' | '_top'
  
  // === PROVIDERS ===
  provider?: 'next' | 'cloudflare' | 'cloudinary' | 'custom'
  imageOptions?: ImageOptions           // OpÃ§Ãµes de otimizaÃ§Ã£o
  customProvider?: ImageProvider        // Provider customizado
  
  // === FALLBACKS ===
  fallback?: string                     // URL de fallback
  fallbackComponent?: React.ReactNode   // Componente de fallback
  showFallbackOnError?: boolean         // Exibir fallback em erro
  
  // === PERFORMANCE ===
  priority?: boolean                    // Loading prioritÃ¡rio
  lazy?: boolean                        // Lazy loading
  eager?: boolean                       // Loading imediato
  preload?: boolean                     // Preload no head
  
  // === ACCESSIBILITY ===
  role?: string                         // Role ARIA
  'aria-label'?: string                 // Label ARIA
  'aria-describedby'?: string           // DescriÃ§Ã£o ARIA
  
  // === EVENTS ===
  onLoad?: (event: React.SyntheticEvent<HTMLImageElement>) => void
  onError?: (event: React.SyntheticEvent<HTMLImageElement>) => void
  onLoadStart?: (event: React.SyntheticEvent<HTMLImageElement>) => void
  onClick?: (event: React.MouseEvent<HTMLImageElement>) => void
}
```

---

## ğŸª Exemplos PrÃ¡ticos

### Galeria de Produtos
```tsx
const ProductGallery = ({ products }) => (
  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
    {products.map(product => (
      <Thumbnail 
        key={product.id}
        src={product.image}
        alt={product.name}
        href={`/products/${product.id}`}
        width={200}
        lazy
      />
    ))}
  </div>
)
```

### Lista de UsuÃ¡rios
```tsx
const UserList = ({ users }) => (
  <div className="space-y-4">
    {users.map(user => (
      <div key={user.id} className="flex items-center gap-3">
        <Avatar 
          src={user.avatar}
          alt={user.name}
          width={40}
          height={40}
        />
        <div>
          <h3>{user.name}</h3>
          <p className="text-gray-600">{user.role}</p>
        </div>
      </div>
    ))}
  </div>
)
```

### Hero Section Responsivo
```tsx
const HeroSection = () => (
  <div className="relative">
    <Hero 
      src="/hero-banner.jpg"
      alt="Hero banner"
      width={1920}
      height={1080}
      sizes="100vw"
      priority
      responsive
    />
    <div className="absolute inset-0 flex items-center justify-center">
      <h1 className="text-white text-4xl font-bold">
        Bem-vindo ao nosso site
      </h1>
    </div>
  </div>
)
```

### Sistema de Ãcones
```tsx
const IconButton = ({ icon, color = "#3b82f6", size = 24, ...props }) => (
  <button className="p-2 rounded hover:bg-gray-100" {...props}>
    <SvgIcon 
      src={`/icons/${icon}.svg`}
      width={size}
      height={size}
      svgFill={color}
    />
  </button>
)

// Uso
<IconButton icon="heart" color="#ef4444" />
<IconButton icon="share" color="#10b981" />
<IconButton icon="bookmark" color="#8b5cf6" />
```

---

## ğŸ› ï¸ ConfiguraÃ§Ã£o de Ambiente

### .env.local
```env
# Cloudflare Images
NEXT_PUBLIC_CLOUDFLARE_ACCOUNT_HASH=your_hash_here

# Cloudinary
NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME=your_cloud_name
```

### next.config.js
```js
/** @type {import('next').NextConfig} */
const nextConfig = {
  images: {
    domains: ['imagedelivery.net', 'res.cloudinary.com'], // Para providers externos
    formats: ['image/webp', 'image/avif'], // Formatos otimizados
  },
}

module.exports = nextConfig
```

---

## ğŸ”§ Troubleshooting

### SVG nÃ£o estÃ¡ mudando de cor
1. **Verifique se Ã© SVG**: O arquivo tem extensÃ£o `.svg`?
2. **CSS Filters vs Inline**: Use `renderSvgInline` para controle total
3. **SVG com currentColor**: Alguns SVGs usam `currentColor` que funciona melhor com `svgColor`

### Imagens nÃ£o carregam
1. **Verifique o provider**: EstÃ¡ configurado corretamente?
2. **VariÃ¡veis de ambiente**: As env vars estÃ£o definidas?
3. **DomÃ­nios permitidos**: Adicionou no `next.config.js`?

### Performance lenta
1. **Use lazy loading**: PadrÃ£o para imagens fora da viewport
2. **Priority apenas para above-the-fold**: NÃ£o abuse do `priority`
3. **Responsive images**: Use `sizes` para diferentes breakpoints

---

## ğŸ“š Recursos Adicionais

- **PÃ¡gina de Exemplos**: `/docs/images` - DocumentaÃ§Ã£o visual completa
- **Componente Logo**: IntegraÃ§Ã£o com sistema de logos
- **Chakra UI**: CompatÃ­vel com o design system
- **TypeScript**: Tipagem completa para todas as props

---

## ğŸ¯ Melhores PrÃ¡ticas

### âœ… Recomendado
```tsx
// Use componentes de conveniÃªncia
<Avatar src="/user.jpg" width={40} />

// Priority apenas para imagens importantes
<Hero src="/banner.jpg" priority />

// Lazy loading para conteÃºdo
<Thumbnail src="/product.jpg" lazy />

// SVG inline apenas quando necessÃ¡rio
<SvgIcon src="/icon.svg" svgFill="#3b82f6" />
```

### âŒ Evite
```tsx
// NÃ£o abuse do priority
<Image src="/footer-logo.jpg" priority /> // âŒ

// NÃ£o use inline SVG desnecessariamente
<Image src="/simple-icon.svg" renderSvgInline /> // âŒ Use svgColor

// NÃ£o esqueÃ§a do alt text
<Image src="/important.jpg" /> // âŒ Faltou alt
```

---

**ğŸš€ Agora vocÃª tem controle total sobre imagens em seu projeto Next.js!**
